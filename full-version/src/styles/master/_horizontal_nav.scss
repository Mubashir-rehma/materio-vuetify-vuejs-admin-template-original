@use "./placeholders";
@use "./variables";
@use "@layouts/styles/mixins";

.layout-horizontal-nav {
  .nav-item-icon {
    font-size: 1.2rem;
    margin-inline-end: 0.75rem;
  }

  // Disabled nav items
  .nav-link,
  .nav-group {
    &.disabled {
      opacity: 0.35;
      pointer-events: none;
    }

    // Set width of inner nav group and link
    &.sub-item {
      min-inline-size: 12rem;
    }
  }

  .nav-link {
    &:hover > a {
      @extend %horizontal-nav-item-hover-styles;
    }

    a {
      @extend %horizontal-nav-item;
    }

    &.sub-item {
      a {
        &.router-link-active {
          @extend %horizontal-nav-sub-nav-link-styles;
        }
      }
    }

    &:not(.sub-item) {
      a {
        @extend %horizontal-nav-items-roundness;

        &.router-link-active {
          @extend %nav-link-active-styles;
        }
      }
    }
  }

  .nav-group {
    .popper-triggerer {
      .nav-group-label {
        @extend %horizontal-nav-item;
      }
    }

    // For indicating opened groups when navigating in group children
    &:hover > .popper-triggerer > .nav-group-label {
      @extend %horizontal-nav-item-hover-styles;
    }

    // 👉 Top level group
    &:not(.sub-item) {
      > .popper-triggerer {
        position: relative;

        /*
          ℹ️ The Bridge
          This after pseudo will work as bridge when we have space between popper triggerer and popper content
          Initially it will have pointer events none for normal behavior and once the content is shown it will
            work as bridge by setting pointer events to `auto`
        */
        &::after {
          position: absolute;
          block-size: 20px;
          content: "";
          inline-size: 100%;
          inset-block-start: 100%;
          inset-inline-start: 0;
          pointer-events: none;
        }
      }

      // Enable the pseudo bridge when content is shown by setting pointer events to `auto`
      &.show-content > .popper-triggerer::after {
        pointer-events: auto;
      }

      > .popper-triggerer > .nav-group-label {
        @extend %horizontal-nav-items-roundness;
      }

      &.active {
        > .popper-triggerer > .nav-group-label {
          @extend %nav-link-active-styles;
        }
      }

      > .popper-content {
        // ℹ️ Add space between popper wrapper & content
        margin-block-start: variables.$horizontal-nav-padding !important;
      }
    }

    // 👉 Sub group
    &.sub-item {
      &.active {
        > .popper-triggerer > .nav-group-label {
          @extend %horizontal-nav-sub-nav-group-styles;
        }
      }
    }

    .nav-group-arrow {
      font-size: 1.2rem;

      /*
        ℹ️ ml-auto won't matter in top level group (because we haven't specified fixed width for top level groups)
        but we wrote generally because we don't want to become so specific
      */
      margin-inline-start: auto;
    }

    &.popper-inline-end {
      .nav-group-arrow {
        transform: rotateZ(270deg);

        @include mixins.rtl {
          transform: rotateZ(90deg);
        }
      }
    }

    .nav-item-title {
      margin-inline-end: 0.3rem;
    }

    .popper-content {
      @extend %horizontal-nav-popper-content-initial-styles;

      background-color: white;
      border-radius: 6px;
      box-shadow: 0 2px 5px 3px rgb(0 0 0 / 10%);
      padding-block: 0.3rem;

      // Set max-height for the popper content
      > div {
        // 120px is combined height of navbar & horizontal nav
        max-block-size: calc((var(--vh, 1vh) * 100) - 120px - 4rem);
      }
    }

    &.show-content > .popper-content {
      @extend %horizontal-nav-popper-content-visible-styles;
    }
  }
}
